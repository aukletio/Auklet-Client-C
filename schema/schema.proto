syntax = "proto3";
package schema;
option go_package = "github.com/ESG-USA/Auklet-Client-C/schema";

import "device/device.proto";

// Exit represents the termination of an app.
message Exit {
	string application = 1;
	string checksum = 2;
	string publicIP = 3;
	string id = 4;
	string timestamp = 5;
	int32 exitStatus = 6;
	string signal = 7;
	message StackFrame {
		uint64 functionAddress = 1;
		uint64 callSiteAddress = 2;
	}
	repeated StackFrame stackTrace = 8;
	string macAddressHash = 9;
	device.Metrics systemMetrics = 10;
}

message Profile {
	string application = 1;
	string checksum = 2;
	string publicIP = 3;
	string id = 4;
	int64 timestamp = 5; // Unix epoch milliseconds
	message Tree {
		uint64 functionAddress = 1;
		uint64 callSiteAddress = 2;
		uint32 nCalls = 3;
		uint32 nSamples = 4;
		repeated Tree callees = 5;
	}
	Tree tree = 6;
}


// AppLog is a message generated by an app for the purposes of remote monitoring
// by users.
message AppLog {
	string application = 1;
	string checksum = 2;
	string publicIP = 3;
	string id = 4;
	string timestamp = 5;
	bytes message = 6;
	string macAddressHash = 7;
	device.Metrics systemMetrics = 8;
}

// AgentLog is a log message generated by an agent; typically an error or info
// message.
message AgentLog {
	string level = 1;
	string message = 2;
}
